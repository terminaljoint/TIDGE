<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TIGEN v2 - Live Demo</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Monaco', 'Courier New', monospace;
      background: #0a0b0d;
      color: #00ff88;
      overflow: hidden;
      padding: 20px;
    }
    
    .container {
      display: flex;
      gap: 20px;
      height: 100vh;
    }
    
    .canvas-area {
      flex: 1;
      display: flex;
      flex-direction: column;
      border: 2px solid #00ff88;
      border-radius: 8px;
      overflow: hidden;
      background: rgba(15, 16, 19, 0.5);
    }
    
    #canvas {
      flex: 1;
      display: block;
      background: linear-gradient(135deg, #0a0b0d 0%, #1a1d22 100%);
      cursor: crosshair;
    }
    
    .controls {
      background: rgba(15, 16, 19, 0.9);
      padding: 15px;
      border-top: 1px solid rgba(0, 255, 136, 0.2);
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    button {
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid #00ff88;
      color: #00ff88;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-family: inherit;
      transition: all 0.2s;
      font-size: 12px;
      font-weight: bold;
    }
    
    button:hover {
      background: rgba(0, 255, 136, 0.2);
      transform: scale(1.05);
      box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
    }
    
    button.active {
      background: #00ff88;
      color: #0a0b0d;
    }
    
    .panel {
      width: 350px;
      background: rgba(15, 16, 19, 0.95);
      border: 2px solid #00ff88;
      border-radius: 8px;
      padding: 15px;
      overflow-y: auto;
      font-size: 12px;
    }
    
    .panel-title {
      font-size: 14px;
      font-weight: bold;
      color: #00ff88;
      margin-bottom: 15px;
      border-bottom: 1px solid rgba(0, 255, 136, 0.2);
      padding-bottom: 10px;
    }
    
    .stat {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      padding: 8px;
      background: rgba(0, 255, 136, 0.05);
      border-radius: 3px;
    }
    
    .stat-label {
      color: #888;
      font-weight: bold;
    }
    
    .stat-value {
      color: #00ff88;
      font-weight: bold;
    }
    
    .log {
      background: rgba(10, 11, 13, 0.5);
      border: 1px solid rgba(0, 255, 136, 0.2);
      border-radius: 4px;
      padding: 10px;
      height: 250px;
      overflow-y: auto;
      margin-top: 10px;
      font-size: 11px;
    }
    
    .log-entry {
      margin-bottom: 4px;
      padding: 4px;
      border-left: 2px solid #00ff88;
      padding-left: 8px;
    }
    
    .log-entry.info {
      color: #00ff88;
    }
    
    .log-entry.success {
      color: #00ff88;
    }
    
    .log-entry.error {
      color: #ff6450;
      border-left-color: #ff6450;
    }
    
    .demo-item {
      background: rgba(0, 255, 136, 0.05);
      border: 1px solid rgba(0, 255, 136, 0.1);
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .demo-item:hover {
      background: rgba(0, 255, 136, 0.15);
      border-color: #00ff88;
    }
    
    ::-webkit-scrollbar {
      width: 6px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(0, 255, 136, 0.05);
    }
    
    ::-webkit-scrollbar-thumb {
      background: rgba(0, 255, 136, 0.2);
      border-radius: 3px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: rgba(0, 255, 136, 0.4);
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Canvas Area -->
    <div class="canvas-area">
      <canvas id="canvas"></canvas>
      <div class="controls">
        <button onclick="runDemo1()">üé¨ Demo 1: Rotating Cubes</button>
        <button onclick="runDemo2()">üî¥ Demo 2: Physics Balls</button>
        <button onclick="runDemo3()">üéÆ Demo 3: Player Control</button>
        <button onclick="runDemo4()">‚ú® Demo 4: Particles</button>
        <button onclick="runDemo5()">üí° Demo 5: Lighting</button>
        <button onclick="clearScene()">üßπ Clear</button>
      </div>
    </div>
    
    <!-- Info Panel -->
    <div class="panel">
      <div class="panel-title">‚öôÔ∏è ENGINE STATS</div>
      
      <div class="stat">
        <span class="stat-label">FPS:</span>
        <span class="stat-value" id="fpsValue">0</span>
      </div>
      
      <div class="stat">
        <span class="stat-label">Entities:</span>
        <span class="stat-value" id="entitiesValue">0</span>
      </div>
      
      <div class="stat">
        <span class="stat-label">Faces:</span>
        <span class="stat-value" id="facesValue">0</span>
      </div>
      
      <div class="stat">
        <span class="stat-label">Memory:</span>
        <span class="stat-value" id="memoryValue">0 MB</span>
      </div>
      
      <div class="stat">
        <span class="stat-label">Physics:</span>
        <span class="stat-value" id="physicsValue">Enabled</span>
      </div>
      
      <div class="panel-title" style="margin-top: 20px;">üéØ DEMOS</div>
      
      <div class="demo-item" onclick="runDemo1()">
        <strong>Rotating Cubes</strong>
        <p style="color: #888; font-size: 11px; margin-top: 4px;">Multiple rotating boxes with different colors</p>
      </div>
      
      <div class="demo-item" onclick="runDemo2()">
        <strong>Physics Simulation</strong>
        <p style="color: #888; font-size: 11px; margin-top: 4px;">Spheres falling with gravity and physics</p>
      </div>
      
      <div class="demo-item" onclick="runDemo3()">
        <strong>Player Controller</strong>
        <p style="color: #888; font-size: 11px; margin-top: 4px;">WASD + Mouse camera control</p>
      </div>
      
      <div class="demo-item" onclick="runDemo4()">
        <strong>Particle Effects</strong>
        <p style="color: #888; font-size: 11px; margin-top: 4px;">Emitting particles in 3D space</p>
      </div>
      
      <div class="demo-item" onclick="runDemo5()">
        <strong>Lighting System</strong>
        <p style="color: #888; font-size: 11px; margin-top: 4px;">Multiple light sources and ambient</p>
      </div>
      
      <div class="panel-title" style="margin-top: 20px;">üìù LOG</div>
      <div class="log" id="log"></div>
    </div>
  </div>
  
  <script src="engine.js"></script>
  <script src="logic-system.js"></script>
  
  <script>
    let demoEngine = {
      scene: null,
      renderer: null,
      gameLoop: null,
      input: null,
      isRunning: false
    };
    
    function log(message, type = 'info') {
      const logEl = document.getElementById('log');
      const entry = document.createElement('div');
      entry.className = `log-entry ${type}`;
      entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      logEl.appendChild(entry);
      logEl.scrollTop = logEl.scrollHeight;
      
      // Keep only last 50 entries
      while (logEl.children.length > 50) {
        logEl.removeChild(logEl.firstChild);
      }
    }
    
    function initEngine() {
      if (demoEngine.isRunning) return;
      
      const canvas = document.getElementById('canvas');
      canvas.width = window.innerWidth * 0.65;
      canvas.height = window.innerHeight - 100;
      
      demoEngine.renderer = new Renderer(canvas);
      demoEngine.scene = demoEngine.renderer.createScene('Demo Scene');
      demoEngine.gameLoop = new GameLoop(60);
      demoEngine.input = new InputManager();
      demoEngine.isRunning = true;
      
      demoEngine.gameLoop.setCallback(updateStats);
      demoEngine.gameLoop.start();
      
      log('Engine initialized', 'success');
    }
    
    function clearScene() {
      if (demoEngine.scene) {
        demoEngine.scene.entities = [];
        demoEngine.scene.rootEntities = [];
        log('Scene cleared', 'info');
      }
    }
    
    function runDemo1() {
      initEngine();
      clearScene();
      
      log('Demo 1: Rotating Cubes', 'success');
      
      const colors = [
        [1, 0, 0],     // Red
        [0, 1, 0],     // Green
        [0, 0, 1],     // Blue
        [1, 1, 0],     // Yellow
        [1, 0, 1],     // Magenta
        [0, 1, 1]      // Cyan
      ];
      
      for (let i = 0; i < 6; i++) {
        const cube = demoEngine.scene.createEntity(`Cube_${i}`);
        const angle = (i / 6) * Math.PI * 2;
        cube.transform.setPosition(Math.cos(angle) * 3, 0, Math.sin(angle) * 3);
        
        const mesh = cube.addComponent(Mesh);
        mesh.setGeometry('box');
        const [r, g, b] = colors[i];
        mesh.setColor(r, g, b);
        
        const rotator = cube.addScript(RotatingObject);
        rotator.rotationSpeed = new Vector3(0.5, 1, 0.2);
      }
      
      log('Created 6 rotating cubes arranged in circle', 'info');
    }
    
    function runDemo2() {
      initEngine();
      clearScene();
      
      log('Demo 2: Physics Simulation', 'success');
      
      for (let i = 0; i < 5; i++) {
        const sphere = demoEngine.scene.createEntity(`Ball_${i}`);
        sphere.transform.setPosition(Math.random() * 4 - 2, 5 + i * 2, Math.random() * 4 - 2);
        
        const mesh = sphere.addComponent(Mesh);
        mesh.setGeometry('sphere');
        mesh.setColor(Math.random(), Math.random(), Math.random());
        
        const physics = sphere.addComponent(Physics);
        physics.mass = 1;
        physics.useGravity = true;
        physics.bounciness = 0.7;
      }
      
      log('Created 5 bouncing balls with physics', 'info');
    }
    
    function runDemo3() {
      initEngine();
      clearScene();
      
      log('Demo 3: Player Control (WASD + Mouse)', 'success');
      
      // Create player cube
      const player = demoEngine.scene.createEntity('Player');
      const playerMesh = player.addComponent(Mesh);
      playerMesh.setGeometry('box');
      playerMesh.setColor(0, 1, 0);
      player.addScript(PlayerController);
      
      // Create ground
      const ground = demoEngine.scene.createEntity('Ground');
      ground.transform.setPosition(0, -3, 0);
      ground.transform.setScale(10, 0.5, 10);
      const groundMesh = ground.addComponent(Mesh);
      groundMesh.setGeometry('box');
      groundMesh.setColor(0.3, 0.3, 0.3);
      
      // Create some obstacles
      for (let i = 0; i < 3; i++) {
        const box = demoEngine.scene.createEntity(`Obstacle_${i}`);
        box.transform.setPosition(Math.random() * 6 - 3, 0, Math.random() * 6 - 3);
        const mesh = box.addComponent(Mesh);
        mesh.setGeometry('box');
        mesh.setColor(1, 0.5, 0);
      }
      
      log('Created scene with player control', 'info');
      log('Use WASD to move, Mouse button to look around', 'info');
    }
    
    function runDemo4() {
      initEngine();
      clearScene();
      
      log('Demo 4: Particle Effects', 'success');
      
      // Central emitter
      const emitter = demoEngine.scene.createEntity('ParticleEmitter');
      const particles = emitter.addComponent(ParticleSystem);
      particles.maxParticles = 5000;
      particles.emissionRate = 300;
      particles.lifetime = 3;
      particles.speed = 8;
      emitter.addScript(ParticleEmitter);
      
      // Add some static objects
      const sphere = demoEngine.scene.createEntity('CentralSphere');
      const sphereMesh = sphere.addComponent(Mesh);
      sphereMesh.setGeometry('sphere');
      sphereMesh.setColor(0, 1, 0.8);
      
      log('Created particle emitter', 'info');
      log(`Max particles: ${particles.maxParticles}`, 'info');
      log(`Emission rate: ${particles.emissionRate}/sec`, 'info');
    }
    
    function runDemo5() {
      initEngine();
      clearScene();
      
      log('Demo 5: Lighting System', 'success');
      
      // Create some spheres
      const spheres = [
        { x: -3, y: 0, z: 0, color: [1, 0, 0] },
        { x: 0, y: 0, z: 0, color: [0, 1, 0] },
        { x: 3, y: 0, z: 0, color: [0, 0, 1] }
      ];
      
      for (const s of spheres) {
        const sphere = demoEngine.scene.createEntity(`Sphere_${s.x}`);
        sphere.transform.setPosition(s.x, s.y, s.z);
        const mesh = sphere.addComponent(Mesh);
        mesh.setGeometry('sphere');
        mesh.setColor(...s.color);
      }
      
      // Create rotating lights
      const lightPositions = [
        [5, 2, 5],
        [-5, 2, -5],
        [5, 2, -5]
      ];
      
      for (let i = 0; i < lightPositions.length; i++) {
        const lightEntity = demoEngine.scene.createEntity(`Light_${i}`);
        const [x, y, z] = lightPositions[i];
        lightEntity.transform.setPosition(x, y, z);
        
        const light = lightEntity.addComponent(Light);
        light.type = 'point';
        light.color = { r: Math.random(), g: Math.random(), b: Math.random() };
        light.intensity = 1.5;
        light.range = 15;
        
        // Make lights pulsate
        lightEntity.addScript(LightPulsator);
      }
      
      log('Created scene with 3 pulsating lights', 'info');
      log('Lights: Point (range 15)', 'info');
    }
    
    function updateStats() {
      if (!demoEngine.gameLoop) return;
      
      document.getElementById('fpsValue').textContent = demoEngine.gameLoop.fps;
      document.getElementById('entitiesValue').textContent = demoEngine.scene?.entities.length || 0;
      
      let faceCount = 0;
      if (demoEngine.scene) {
        faceCount = demoEngine.scene.entities.reduce((sum, e) => {
          return sum + (e.components.mesh && e.components.mesh.geometry ? e.components.mesh.geometry.getFaceCount() : 0);
        }, 0);
      }
      document.getElementById('facesValue').textContent = faceCount;
      
      if (performance.memory) {
        const mb = (performance.memory.usedJSHeapSize / 1048576).toFixed(1);
        document.getElementById('memoryValue').textContent = `${mb} MB`;
      }
    }
    
    // Start with demo 1
    window.addEventListener('load', () => {
      setTimeout(() => runDemo1(), 500);
    });
    
    // Make functions global
    window.runDemo1 = runDemo1;
    window.runDemo2 = runDemo2;
    window.runDemo3 = runDemo3;
    window.runDemo4 = runDemo4;
    window.runDemo5 = runDemo5;
    window.clearScene = clearScene;
    window.log = log;
  </script>
</body>
</html>
